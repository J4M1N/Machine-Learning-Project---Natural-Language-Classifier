from sklearn.model_selection import train_test_split
import pickle
import numpy as np
import tensorflow as tf

RANDOM_SEED = 1276
def train_model():
    with open('new_dataset', 'r' encoding='utf-8') as f:
        read_object = json.load(f)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=RANDOM_SEED)

model = Sequential([
		Dense(16, activation='relu', input_shape=(2,)),
        Dropout(0.1),
        Dense(8, activation='relu'),   # Second hidden layer
		Dense(2, activation='softmax')
])

model.compile(optimizer=Adam(learning_rate=0.01),
							loss='sparse_categorical_crossentropy',
							metrics=['accuracy'])

model.fit(X_train, y_train, epochs=50, batch_size=32, validation_split=0.1, verbose=0, callbacks=[print_callback])

loss, accuracy = model.evaluate(X_test, y_test, verbose=0)

print(f"Final Test Accuracy: {accuracy:.4%}")

y_pred = model.predict(X_test)
print("\nClassification Report:\n", classification_report(y_test, y_pred))